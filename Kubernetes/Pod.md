Поды в k8s это дополнительный уровень абстракции для рабочей нагрузки. Поды добавляют новую функциональность для запущенного в них приложения:
- Разделение ресурсов
- Продвинутое планирование
- Health probes
- Restart policies
- Security policies
- Termination control
- Volumes

Полный список атрибутов пода можно получить командой:
``` bash
kubectl explain pods --recursive
```
Подробная информация об отдельном атрибуте:
``` bash
kubectl explain pod.spec.restartPolicy
```
Поды легковесные и несут минимум накладных расходов.

#### Разделение ресурсов
Поды выполняют один или несколько контейнеров. Все контейнеры внутри пода используют общую среду исполнения:
- Разделяемая файловая система и тома (mnt namespace)
- Разделяемый сетевой стек (net namespace)
- Разделяемая память (IPC namespace)
- Разделяемое дерево процессов (pid namespace)
- Разделяемое имя хоста (utc namespace)

#### Планирование подов
K8s размещает все контейнеры пода на одной ноде. Если есть необходимость размесить несколько подов на одной ноде, нужно воспользоваться одним из механизмов планирования:
- nodeSelectors
- Affinity и anti-affinity
- Topology spread constraints
- Resource requests и resource limits

#### Жизненный цикл подов
Поды по своей сути *смертны* и *неизменяемы*.

Смертность подов означает, что как только под закончил выполнение задачи он завершает свою работу. Он удаляется из системы и его невозможно перезапустить. Аналогично, если во время его работы происходит ошибка.

Неизменяемость означает, что невозможно внести изменения в конфигурацию пода, после того как он был запущен. Если есть необходимость изменить под, нужно создать новый и удалить старый.

Фазы жизненного цикла подов:
- Под объявлен в файле YAML, который отправляется в API server
- **Pending**. Scheduler ищет подходящую ноду для запуска пода
- **Running**. Под присвоен ноде, все его контейнеры стартовали
- **Succeeded**. Под успешно завершил свою работу

#### Restart policies
В отличие от подов, контейнеры могут быть перезапущены. Это делает kubelet, а политика рестарта задаётся параметром ```spec.restartPolicy```, который может принимать следующие значения:
- Always
- Nevel
- OnFailure
Этот параметр распространяется на все контейнеры пода, кроме контейнеров инициализации *(init containers)*.

#### The pod network
Каждый кластер k8s запускает pod network и автоматически подсоединяет к ней все поды. Обычно это оверлейная сеть 2 уровня, которая распространяется на все ноды кластера и позволяет подам общаться друг с другом.

Pod network реализуется через сторонние плагины, которые взаимодействуют с k8s через *Container Network Interface (CNI)*.

#### Init containers
Init container - специальный тип контейнера, который запускается в том же поде, что и основное приложение. K8s гарантирует, что эти контейнеры запустятся и завершат работу до того, как основное приложение начнёт работу. Также гарантируется, что они отработают только один раз. Цель использования init container - подготовка окружения для основного приложения.